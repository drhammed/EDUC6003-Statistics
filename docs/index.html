<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Hammed Akande">

<title>EDUC 6003 Advanced Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">EDUC 6003 Advanced Statistics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#chapter-1" id="toc-chapter-1" class="nav-link active" data-scroll-target="#chapter-1">Chapter 1</a>
  <ul class="collapse">
  <li><a href="#introduction-to-reliability-index-analysis" id="toc-introduction-to-reliability-index-analysis" class="nav-link" data-scroll-target="#introduction-to-reliability-index-analysis">Introduction to Reliability Index Analysis</a>
  <ul class="collapse">
  <li><a href="#what-is-reliability" id="toc-what-is-reliability" class="nav-link" data-scroll-target="#what-is-reliability">What is Reliability?</a></li>
  </ul></li>
  <li><a href="#classical-test-theory-ctt-and-coefficient-alpha" id="toc-classical-test-theory-ctt-and-coefficient-alpha" class="nav-link" data-scroll-target="#classical-test-theory-ctt-and-coefficient-alpha">Classical Test Theory (CTT) and Coefficient Alpha</a>
  <ul class="collapse">
  <li><a href="#coefficient-alpha-cronbachs-alpha" id="toc-coefficient-alpha-cronbachs-alpha" class="nav-link" data-scroll-target="#coefficient-alpha-cronbachs-alpha">Coefficient Alpha (Cronbach’s Alpha)</a></li>
  <li><a href="#coefficient-omega" id="toc-coefficient-omega" class="nav-link" data-scroll-target="#coefficient-omega">Coefficient Omega</a></li>
  </ul></li>
  <li><a href="#calculations-in-r" id="toc-calculations-in-r" class="nav-link" data-scroll-target="#calculations-in-r">Calculations in R</a></li>
  <li><a href="#loading-the-bfi-dataset" id="toc-loading-the-bfi-dataset" class="nav-link" data-scroll-target="#loading-the-bfi-dataset">Loading the (BFI) dataset</a>
  <ul class="collapse">
  <li><a href="#selecting-openness-items" id="toc-selecting-openness-items" class="nav-link" data-scroll-target="#selecting-openness-items">Selecting Openness Items</a></li>
  <li><a href="#handling-missing-data" id="toc-handling-missing-data" class="nav-link" data-scroll-target="#handling-missing-data">Handling Missing Data</a></li>
  </ul></li>
  <li><a href="#calculating-cronbachs-alpha" id="toc-calculating-cronbachs-alpha" class="nav-link" data-scroll-target="#calculating-cronbachs-alpha">Calculating Cronbach’s Alpha</a>
  <ul class="collapse">
  <li><a href="#a.-we-can-use-the-psych-package-in-r" id="toc-a.-we-can-use-the-psych-package-in-r" class="nav-link" data-scroll-target="#a.-we-can-use-the-psych-package-in-r">a. We can use the psych Package in R</a></li>
  </ul></li>
  <li><a href="#confirmatory-factor-analysis-cfa" id="toc-confirmatory-factor-analysis-cfa" class="nav-link" data-scroll-target="#confirmatory-factor-analysis-cfa">Confirmatory Factor Analysis (CFA)</a>
  <ul class="collapse">
  <li><a href="#a.-specifying-the-cfa-model" id="toc-a.-specifying-the-cfa-model" class="nav-link" data-scroll-target="#a.-specifying-the-cfa-model">a. Specifying the CFA Model</a></li>
  <li><a href="#b.-fitting-the-cfa-model" id="toc-b.-fitting-the-cfa-model" class="nav-link" data-scroll-target="#b.-fitting-the-cfa-model">b. Fitting the CFA Model</a></li>
  </ul></li>
  <li><a href="#calculating-categorical-omega" id="toc-calculating-categorical-omega" class="nav-link" data-scroll-target="#calculating-categorical-omega">Calculating Categorical Omega</a></li>
  <li><a href="#bifactor-models" id="toc-bifactor-models" class="nav-link" data-scroll-target="#bifactor-models">Bifactor Models</a>
  <ul class="collapse">
  <li><a href="#omega-hierarchical-ωh" id="toc-omega-hierarchical-ωh" class="nav-link" data-scroll-target="#omega-hierarchical-ωh">Omega Hierarchical (ωh)</a></li>
  <li><a href="#higher-order-models" id="toc-higher-order-models" class="nav-link" data-scroll-target="#higher-order-models">Higher-Order Models</a></li>
  </ul></li>
  <li><a href="#exploratory-omega-estimates" id="toc-exploratory-omega-estimates" class="nav-link" data-scroll-target="#exploratory-omega-estimates">Exploratory Omega Estimates</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">EDUC 6003 Advanced Statistics</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Hammed Akande </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="chapter-1" class="level1">
<h1>Chapter 1</h1>
<section id="introduction-to-reliability-index-analysis" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-reliability-index-analysis">Introduction to Reliability Index Analysis</h2>
<p>This tutorial will serve as a Guide to Enhanced Reliability Estimation with R</p>
<section id="what-is-reliability" class="level3">
<h3 class="anchored" data-anchor-id="what-is-reliability">What is Reliability?</h3>
<p>Reliability refers to the consistency and precision of measurement instruments. In psychological testing, it assesses the extent to which a test produces stable and consistent results.</p>
<section id="importance-of-reliability" class="level4">
<h4 class="anchored" data-anchor-id="importance-of-reliability">Importance of Reliability</h4>
<p><em>Measurement Precision</em>: Ensures that the scores accurately reflect the true attributes being measured.</p>
<p><em>Research Validity</em>: High reliability is a prerequisite for valid conclusions and replicable research findings.</p>
<p><em>Error Reduction</em>: Minimizes the impact of random errors, enhancing the clarity of observed relationships between constructs.</p>
</section>
<section id="types-of-reliability" class="level4">
<h4 class="anchored" data-anchor-id="types-of-reliability">Types of Reliability</h4>
<p><em>Internal Consistency</em>: Degree to which items within a test measure the same construct.</p>
<p><em>Test-Retest Reliability</em>: Consistency of scores over time.</p>
<p><em>Inter-Rater Reliability</em>: Agreement between different raters or observers.</p>
</section>
</section>
</section>
<section id="classical-test-theory-ctt-and-coefficient-alpha" class="level2">
<h2 class="anchored" data-anchor-id="classical-test-theory-ctt-and-coefficient-alpha">Classical Test Theory (CTT) and Coefficient Alpha</h2>
<p>Classical Test Theory Overview: CTT posits that each observed score is composed of a true score and an error score:</p>
<p><span class="math display">\[ X = T + E \]</span></p>
<p>where:</p>
<p>𝑋= Observed score 𝑇= True score 𝐸= Error score</p>
<section id="coefficient-alpha-cronbachs-alpha" class="level3">
<h3 class="anchored" data-anchor-id="coefficient-alpha-cronbachs-alpha">Coefficient Alpha (Cronbach’s Alpha)</h3>
<p>This is a widely used measure of internal consistency reliability within CTT. It estimates the extent to which items on a test measure the same underlying construct.</p>
<p><span class="math display">\[
\alpha = \frac{N}{N-1} \left(1 - \frac{\sum \sigma^2_{E}}{\sigma^2_{X}}\right)
\]</span></p>
<p>Where:</p>
<p><span class="math inline">\(\alpha\)</span> = Cronbach’s Alpha</p>
<p>𝑁 = Number of items in the test</p>
<p><span class="math inline">\(\sigma^2_{E}\)</span> = Variance of the error scores</p>
<p><span class="math inline">\(\sigma^2_{X}\)</span> = Variance of the observed total scores</p>
<section id="assumptions-of-alpha" class="level4">
<h4 class="anchored" data-anchor-id="assumptions-of-alpha">Assumptions of Alpha</h4>
<p><em>Unidimensionality</em>: All items measure a single construct.</p>
<p><em>Tau Equivalence</em>: Each item has the same true score variance.</p>
<p><em>Independence of Errors</em>: Error terms are uncorrelated across items.</p>
</section>
<section id="limitations-of-alpha" class="level4">
<h4 class="anchored" data-anchor-id="limitations-of-alpha">Limitations of Alpha</h4>
<p><em>Sensitivity to Tau Equivalence</em>: Violations can lead to underestimation or overestimation of reliability.</p>
<p><em>Assumes Unidimensionality</em>: Not suitable for multidimensional scales without adjustments.</p>
<p><em>Ignores Factor Structure</em>: Does not account for the underlying factor model of the test.</p>
</section>
</section>
<section id="coefficient-omega" class="level3">
<h3 class="anchored" data-anchor-id="coefficient-omega">Coefficient Omega</h3>
<p>Coefficient Omega is a more robust alternative to Cronbach’s Alpha, especially when the assumption of tau-equivalence (equal factor loadings) is violated. Omega takes into account the factor structure of the test, making it suitable for both unidimensional and multidimensional scales.</p>
<section id="types-of-omega" class="level4">
<h4 class="anchored" data-anchor-id="types-of-omega">Types of Omega</h4>
<p><em>Omega Total (ωₜ</em>): Accounts for all common factors, both general and specific.</p>
<p><em>Omega Hierarchical (ωₕ)</em>: Represents the proportion of variance attributable to a general factor alone.</p>
<p>Omega Total is given by:</p>
<p><span class="math display">\[
\omega_t = \frac{\sum_{i=1}^{k} \lambda_i}{\sum_{i=1}^{k} \lambda_i + \sum_{i=1}^{k} \theta_i}
\]</span></p>
<p>Where:</p>
<p><span class="math inline">\(\omega_t\)</span> = Omega Total</p>
<p><span class="math inline">\(\lambda_i\)</span> = Factor loading for item</p>
<p><span class="math inline">\(\theta_i\)</span> = Unique variance (error variance) for item</p>
<p><span class="math inline">\(k\)</span> = Total number of items</p>
<p>For a hierarchical model, Omega Hierarchical is:</p>
<p><span class="math display">\[
\omega_h = \frac{\lambda_g^2}{\lambda_g^2 + \sum_{i=1}^{k} \theta_i}
\]</span></p>
<p>where:</p>
<p><span class="math inline">\(\omega_h\)</span> = Omega Hierarchical</p>
<p><span class="math inline">\(\lambda_g\)</span> = Factor loading of the general factor</p>
<p><span class="math inline">\(\theta_i\)</span> = Unique variance for item <span class="math inline">\(i\)</span></p>
</section>
<section id="advantages-of-omega-over-alpha" class="level4">
<h4 class="anchored" data-anchor-id="advantages-of-omega-over-alpha">Advantages of Omega Over Alpha</h4>
<p><em>Factor Structure Incorporation</em>: Utilizes confirmatory factor analysis (CFA) to model the underlying structure.</p>
<p><em>Less Sensitive to Tau Equivalence Violations</em>: Provides more accurate reliability estimates when tau equivalence is not met.</p>
<p><em>Applicability to Multidimensional Scales</em>: Suitable for tests measuring multiple constructs.</p>
</section>
</section>
</section>
<section id="calculations-in-r" class="level2">
<h2 class="anchored" data-anchor-id="calculations-in-r">Calculations in R</h2>
<p>Here, I will walk through the step-by-step process of calculating Cronbach’s Alpha and Coefficient Omega using R.</p>
<p>Load the necessary packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(psych,lavaan,semTools,tidyverse,semTools,psych,tidyverse,lavaan,rio,parameters,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               nFactors,EGAnet,PCDimension)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-the-bfi-dataset" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-bfi-dataset">Loading the (BFI) dataset</h2>
<p>The Big Five Inventory (BFI) is a widely used dataset in personality psychology, measuring the five major dimensions of personality. We’ll focus on the Openness trait for this tutorial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure you've loaded the psych package</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the BFI dataset</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(bfi)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># load data file</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>bfi <span class="ot">&lt;-</span> bfi</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(bfi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "A1"        "A2"        "A3"        "A4"        "A5"        "C1"       
 [7] "C2"        "C3"        "C4"        "C5"        "E1"        "E2"       
[13] "E3"        "E4"        "E5"        "N1"        "N2"        "N3"       
[19] "N4"        "N5"        "O1"        "O2"        "O3"        "O4"       
[25] "O5"        "gender"    "education" "age"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View the structure of the dataset</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#str(bfi)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The dataset contains 2,800 participants with various demographic and personality-related variables. A1 to A5 correspond to items measuring the Openness trait.</p>
<section id="selecting-openness-items" class="level3">
<h3 class="anchored" data-anchor-id="selecting-openness-items">Selecting Openness Items</h3>
<p>For this tutorial, we’ll focus on five items measuring the Openness trait. These items are typically labeled as A1 to A5 in the BFI dataset.</p>
<section id="a.-extracting-openness-items" class="level4">
<h4 class="anchored" data-anchor-id="a.-extracting-openness-items">a. Extracting Openness Items</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select columns that contain "O" in their names and remove rows with NA values</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>oppeness <span class="ot">&lt;-</span> bfi <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">matches</span>(<span class="st">"^O"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(oppeness)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  O1 O2 O3 O4 O5
1  3  6  3  4  3
2  4  2  4  3  3
3  4  2  5  5  2
4  3  3  4  3  5
5  3  3  4  3  3
6  4  3  5  6  1</code></pre>
</div>
</div>
<p>Each A variable represents a Likert-type item measuring Openness. Responses range from 1 to 6, treated as continuous variables for analysis.</p>
</section>
</section>
<section id="handling-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="handling-missing-data">Handling Missing Data</h3>
<p>Before we continue, let’s check any missing data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(oppeness))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>In this dataset, there are no missing values in the Openness items. If missing values were present, then we need to address that.</p>
</section>
</section>
<section id="calculating-cronbachs-alpha" class="level2">
<h2 class="anchored" data-anchor-id="calculating-cronbachs-alpha">Calculating Cronbach’s Alpha</h2>
<p>Recall that Cronbach’s Alpha (α) is a measure of internal consistency that measures how closely related a set of items are as a group.</p>
<section id="a.-we-can-use-the-psych-package-in-r" class="level3">
<h3 class="anchored" data-anchor-id="a.-we-can-use-the-psych-package-in-r">a. We can use the psych Package in R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Cronbach's Alpha using the psych package</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#alpha_result &lt;- psych::alpha(oppeness)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print(alpha_result)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Because some items were negatively correlated with the first principal component, we probably should reverse them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reversing item O2 and O5</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"O2"</span>,<span class="st">"O5"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>reverse <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  x.reversed <span class="ot">&lt;-</span> <span class="dv">7</span> <span class="sc">+</span><span class="dv">0</span> <span class="sc">-</span> x</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>oppeness[, <span class="fu">c</span>(<span class="st">"O2R"</span>, <span class="st">"O5R"</span>)] <span class="ot">&lt;-</span> <span class="fu">reverse</span>(oppeness[,<span class="fu">c</span>(<span class="st">"O2"</span>,<span class="st">"O5"</span>)])</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># compare original and reversed responses</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>oppeness[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  O1 O2 O3 O4 O5 O2R O5R
1  3  6  3  4  3   1   4
2  4  2  4  3  3   5   4
3  4  2  5  5  2   5   5
4  3  3  4  3  5   4   2
5  3  3  4  3  3   4   4
6  4  3  5  6  1   4   6</code></pre>
</div>
</div>
<p>Now, we can compute the alpha</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute alpha coefficient </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>alpha_result <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">alpha</span>(oppeness[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>)])</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: psych::alpha(x = oppeness[, -c(2, 5)])

  raw_alpha std.alpha G6(smc) average_r S/N   ase mean   sd median_r
       0.6      0.61    0.57      0.24 1.6 0.012  4.6 0.81     0.23

    95% confidence boundaries 
         lower alpha upper
Feldt     0.58   0.6  0.63
Duhachek  0.58   0.6  0.63

 Reliability if an item is dropped:
    raw_alpha std.alpha G6(smc) average_r S/N alpha se  var.r med.r
O1       0.54      0.54    0.48      0.23 1.2    0.014 0.0087  0.23
O3       0.50      0.50    0.44      0.20 1.0    0.015 0.0065  0.20
O4       0.61      0.62    0.56      0.29 1.7    0.012 0.0040  0.29
O2R      0.57      0.57    0.51      0.25 1.3    0.014 0.0077  0.21
O5R      0.52      0.53    0.48      0.22 1.1    0.015 0.0109  0.21

 Item statistics 
       n raw.r std.r r.cor r.drop mean  sd
O1  2726  0.61  0.65  0.51   0.39  4.8 1.1
O3  2726  0.68  0.69  0.59   0.45  4.4 1.2
O4  2726  0.50  0.52  0.29   0.22  4.9 1.2
O2R 2726  0.66  0.60  0.44   0.34  4.3 1.6
O5R 2726  0.67  0.66  0.52   0.42  4.5 1.3

Non missing response frequency for each item
       1    2    3    4    5    6 miss
O1  0.01 0.04 0.08 0.22 0.33 0.33    0
O3  0.03 0.05 0.10 0.28 0.34 0.20    0
O4  0.02 0.05 0.06 0.17 0.32 0.39    0
O2R 0.06 0.10 0.15 0.14 0.26 0.29    0
O5R 0.02 0.07 0.13 0.19 0.32 0.27    0</code></pre>
</div>
</div>
<p>Explanation:</p>
<p>raw_alpha: The Cronbach’s Alpha coefficient.</p>
<p>std.alpha: Standardized alpha, similar to raw_alpha.</p>
<p>G6(smc): Generalizability theory estimate with squared multiple correlations.</p>
<p>average_r: Average inter-item correlation.</p>
<p>S/N: Signal-to-noise ratio.</p>
<p>ase: Asymptotic standard error.</p>
<p>Confidence Intervals: Lower and upper bounds for alpha.</p>
<p>As we can see, the Cronbach’s Alpha for the Openness items is 0.6, indicating strong internal consistency. The average inter-item correlation is 0.24, moderate and within psychological scales.</p>
</section>
</section>
<section id="confirmatory-factor-analysis-cfa" class="level2">
<h2 class="anchored" data-anchor-id="confirmatory-factor-analysis-cfa">Confirmatory Factor Analysis (CFA)</h2>
<p>Confirmatory Factor Analysis (CFA) is used to verify the factor structure of a set of observed variables. In our case, we assume a unidimensional structure.</p>
<section id="a.-specifying-the-cfa-model" class="level3">
<h3 class="anchored" data-anchor-id="a.-specifying-the-cfa-model">a. Specifying the CFA Model</h3>
<p>Let’s specify a one-factor model where all items load on a single latent factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify model</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>mod1f <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="st">openness =~ O1 + O2R + O3 + O4 + O5R</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="b.-fitting-the-cfa-model" class="level3">
<h3 class="anchored" data-anchor-id="b.-fitting-the-cfa-model">b. Fitting the CFA Model</h3>
<p>Fit the Model Using lavaan:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pacman::p_load(lavaan)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate model</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>fit.one.f <span class="ot">&lt;-</span> <span class="fu">cfa</span>(mod1f, <span class="at">data=</span>oppeness, <span class="at">std.lv=</span>T, <span class="at">missing=</span><span class="st">'direct'</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">estimator=</span><span class="st">'MLR'</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The results can be viewed using the summary</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.one.f, <span class="at">fit.measures=</span>T, <span class="at">standardized=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 22 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        15

  Number of observations                          2726
  Number of missing patterns                         1

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                80.583      67.248
  Degrees of freedom                                 5           5
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  1.198
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              1375.389    1049.226
  Degrees of freedom                                10          10
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.311

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.945       0.940
  Tucker-Lewis Index (TLI)                       0.889       0.880
                                                                  
  Robust Comparative Fit Index (CFI)                         0.946
  Robust Tucker-Lewis Index (TLI)                            0.891

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -22078.661  -22078.661
  Scaling correction factor                                  1.167
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)     -22038.369  -22038.369
  Scaling correction factor                                  1.174
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               44187.322   44187.322
  Bayesian (BIC)                             44275.980   44275.980
  Sample-size adjusted Bayesian (SABIC)      44228.321   44228.321

Root Mean Square Error of Approximation:

  RMSEA                                          0.074       0.068
  90 Percent confidence interval - lower         0.061       0.055
  90 Percent confidence interval - upper         0.089       0.081
  P-value H_0: RMSEA &lt;= 0.050                    0.002       0.012
  P-value H_0: RMSEA &gt;= 0.080                    0.280       0.066
                                                                  
  Robust RMSEA                                               0.074
  90 Percent confidence interval - lower                     0.058
  90 Percent confidence interval - upper                     0.090
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.006
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.285

Standardized Root Mean Square Residual:

  SRMR                                           0.029       0.029

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  openness =~                                                           
    O1                0.616    0.029   21.346    0.000    0.616    0.546
    O2R               0.701    0.041   17.170    0.000    0.701    0.449
    O3                0.792    0.032   24.649    0.000    0.792    0.649
    O4                0.357    0.030   11.749    0.000    0.357    0.294
    O5R               0.685    0.036   19.194    0.000    0.685    0.517

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .O1                4.819    0.022  223.110    0.000    4.819    4.273
   .O2R               4.300    0.030  143.782    0.000    4.300    2.754
   .O3                4.439    0.023  189.916    0.000    4.439    3.637
   .O4                4.898    0.023  210.231    0.000    4.898    4.027
   .O5R               4.516    0.025  177.976    0.000    4.516    3.409

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .O1                0.893    0.037   23.923    0.000    0.893    0.702
   .O2R               1.947    0.068   28.607    0.000    1.947    0.798
   .O3                0.862    0.050   17.172    0.000    0.862    0.579
   .O4                1.352    0.052   25.967    0.000    1.352    0.914
   .O5R               1.286    0.059   21.822    0.000    1.286    0.732
    openness          1.000                               1.000    1.000</code></pre>
</div>
</div>
<p>Explanation:</p>
<p>Estimator: Maximum Likelihood (ML).</p>
<p>Test Statistics: The Chi-square test is significant (𝑝&lt;0.001), indicating a poor fit.</p>
<p>Fit Indices:</p>
<p>CFI (0.94): above 0.90.</p>
<p>TLI (0.88): Below the threshold of 0.90.</p>
<p>RMSEA (0.068): Indicates relatively weak fit (≥0.05).</p>
<p>SRMR (0.029): Great fit (≤0.08).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit.one.f, <span class="at">type=</span><span class="st">'cor'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "cor.bollen"

$cov
        O1    O2R     O3     O4    O5R
O1   0.000                            
O2R -0.026  0.000                     
O3   0.037 -0.024  0.000              
O4   0.013 -0.052  0.000  0.000       
O5R -0.044  0.090 -0.022  0.027  0.000

$mean
 O1 O2R  O3  O4 O5R 
  0   0   0   0   0 </code></pre>
</div>
</div>
<p>The fit statistics from the Robust column in the summary suggest that this one-factor model provides a moderate fit to the data. While the Comparative Fit Index (CFI) of 0.94 indicates an acceptable fit, the Tucker-Lewis Index (TLI) of 0.88 is relatively lower, and the Root Mean Square Error of Approximation (RMSEA) is relatively high at 0.08.</p>
<p>The factor loadings (𝜆̂) show significant variation, ranging from 0.357 to 0.792, which implies that the assumption of equal loadings (tau equivalence) does not hold for this openness test. As a result, omega (ωu) should be a more suitable measure of reliability than Cronbach’s alpha. We can compute the ωu estimate by running the <code>reliability</code> function from the semTools package on the one-factor model object (<code>fit1f</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reliability</span>(fit.one.f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        openness
alpha  0.6025464
omega  0.6103741
omega2 0.6103741
omega3 0.6098642
avevar 0.2484010</code></pre>
</div>
</div>
<p><code>omega</code> and <code>omega2</code> measure reliability based on the variance expected by the model, while <code>omega3</code> measures it based on the actual variance seen in your data. The small difference between <code>omega</code> and <code>omega3</code> suggests that the model’s predictions of variance are somewhat close to what’s observed in the sample.</p>
</section>
</section>
<section id="calculating-categorical-omega" class="level2">
<h2 class="anchored" data-anchor-id="calculating-categorical-omega">Calculating Categorical Omega</h2>
<p>Recall that Coefficient Omega (ω) is a reliability estimate that accounts for the factor structure of the test, providing a more accurate measure than Cronbach’s Alpha, especially in the presence of multidimensionality or when tau-equivalence is violated.</p>
<p>Since factor loadings derived from polychoric correlations represent the link between the factor and the underlying latent response variables (not the actual responses from the items), using the ωu formula here would tell us how much of the variance in the latent response variables is explained by the factor. However, this doesn’t reflect the true variance in the sum of the observed item responses. Essentially, in this case, ωu would give us the reliability of a hypothetical total score based on the latent variables rather than the actual observed total score.</p>
<p>To correct for this, Green and Yang (2009b) proposed a new reliability estimate called ωu-cat, which adjusts the reliability calculation to align with the observed total score. This estimate is more accurate for unidimensional scales with categorical items, especially when the response patterns vary across items.</p>
<p>Since the psychoticism items use a 4-point rating scale, I fit the one-factor model using polychoric correlations and the WLSMV estimator (weighted least squares with mean and variance adjustment). This approach is recommended for confirmatory factor analysis involving polychoric correlations, as it is more robust than the maximum likelihood (ML) estimator.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load the data</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>potic <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"potic.csv"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify model</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>mod.one.fCat <span class="ot">&lt;-</span> <span class="st">'psyctcsm =~ DDP1 + DDP2 +</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="st">DDP3 + DDP4'</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate model</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>fit.one.fCat <span class="ot">&lt;-</span> <span class="fu">cfa</span>(mod.one.fCat, <span class="at">data=</span>potic, <span class="at">std.lv=</span><span class="cn">TRUE</span>, <span class="at">ordered=</span>T, <span class="at">estimator=</span><span class="st">'WLSMV'</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieving the results</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.one.fCat, <span class="at">fit.measures=</span><span class="cn">TRUE</span>, <span class="at">standardized=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 10 iterations

  Estimator                                       DWLS
  Optimization method                           NLMINB
  Number of model parameters                        20

                                                  Used       Total
  Number of observations                           498         500

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                 7.117      14.910
  Degrees of freedom                                 2           2
  P-value (Chi-square)                           0.028       0.001
  Scaling correction factor                                  0.480
  Shift parameter                                            0.089
    simple second-order correction                                

Model Test Baseline Model:

  Test statistic                              1635.647    1316.086
  Degrees of freedom                                 6           6
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.244

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.997       0.990
  Tucker-Lewis Index (TLI)                       0.991       0.970
                                                                  
  Robust Comparative Fit Index (CFI)                         0.969
  Robust Tucker-Lewis Index (TLI)                            0.908

Root Mean Square Error of Approximation:

  RMSEA                                          0.072       0.114
  90 Percent confidence interval - lower         0.020       0.065
  90 Percent confidence interval - upper         0.132       0.171
  P-value H_0: RMSEA &lt;= 0.050                    0.200       0.019
  P-value H_0: RMSEA &gt;= 0.080                    0.479       0.880
                                                                  
  Robust RMSEA                                               0.147
  90 Percent confidence interval - lower                     0.089
  90 Percent confidence interval - upper                     0.213
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.004
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.970

Standardized Root Mean Square Residual:

  SRMR                                           0.033       0.033

Parameter Estimates:

  Parameterization                               Delta
  Standard errors                           Robust.sem
  Information                                 Expected
  Information saturated (h1) model        Unstructured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  psyctcsm =~                                                           
    DDP1              0.894    0.028   31.538    0.000    0.894    0.894
    DDP2              0.753    0.028   26.711    0.000    0.753    0.753
    DDP3              0.698    0.030   23.314    0.000    0.698    0.698
    DDP4              0.513    0.040   12.738    0.000    0.513    0.513

Thresholds:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    DDP1|t1          -0.716    0.062  -11.591    0.000   -0.716   -0.716
    DDP1|t2          -0.040    0.056   -0.716    0.474   -0.040   -0.040
    DDP1|t3           0.296    0.057    5.185    0.000    0.296    0.296
    DDP1|t4           1.034    0.069   15.065    0.000    1.034    1.034
    DDP2|t1          -0.580    0.060   -9.693    0.000   -0.580   -0.580
    DDP2|t2           0.208    0.057    3.668    0.000    0.208    0.208
    DDP2|t3           0.562    0.060    9.431    0.000    0.562    0.562
    DDP2|t4           1.096    0.070   15.570    0.000    1.096    1.096
    DDP3|t1          -1.203    0.074  -16.298    0.000   -1.203   -1.203
    DDP3|t2          -0.425    0.058   -7.318    0.000   -0.425   -0.425
    DDP3|t3           0.081    0.056    1.432    0.152    0.081    0.081
    DDP3|t4           0.913    0.066   13.909    0.000    0.913    0.913
    DDP4|t1          -1.605    0.092  -17.382    0.000   -1.605   -1.605
    DDP4|t2          -1.060    0.069  -15.285    0.000   -1.060   -1.060
    DDP4|t3          -0.521    0.059   -8.817    0.000   -0.521   -0.521
    DDP4|t4           0.431    0.058    7.406    0.000    0.431    0.431

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .DDP1              0.201                               0.201    0.201
   .DDP2              0.433                               0.433    0.433
   .DDP3              0.513                               0.513    0.513
   .DDP4              0.737                               0.737    0.737
    psyctcsm          1.000                               1.000    1.000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate reliability</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">reliability</span>(fit.one.fCat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>For constructs with categorical indicators, Zumbo et al.`s (2007) "ordinal alpha" is calculated in addition to the standard alpha, which treats ordinal variables as numeric. See Chalmers (2018) for a critique of "alpha.ord" and the response by Zumbo &amp; Kroc (2019). Likewise, average variance extracted is calculated from polychoric (polyserial) not Pearson correlations.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>           psyctcsm
alpha     0.7680870
alpha.ord 0.8007496
omega     0.7902953
omega2    0.7902953
omega3    0.7932682
avevar    0.5289638</code></pre>
</div>
</div>
<p>We can see that we have two estimates Cronbach’s alpha and differ a bit (0.80 &amp; 0.77). The is because the 2nd alpha estimate is an example of ordinal alpha, which is calculated using a model based on polychoric correlations, while the first alpha was derived using the standard method based on product-moment covariances between the items. It’s important to note that ordinal alpha measures the reliability of the sum of the continuous, latent-response variables rather than the observed categorical item responses. Additionally, it still assumes equal factor loadings (tau equivalence). Because of these limitations, I suggest disregarding the alpha value reported by semTools::reliability when the model uses polychoric correlations.</p>
<p>The values shown in the <code>omega</code> and <code>omega2</code> rows represent the ωu-cat estimate. The <code>omega3</code> row shows a variation where the denominator uses the observed sample variance of ( X ). So, we can see ωu-cat estimates suggest that 79% of the variance in the total score for the psychoticism scale is explained by the single psychoticism factor.</p>
</section>
<section id="bifactor-models" class="level2">
<h2 class="anchored" data-anchor-id="bifactor-models">Bifactor Models</h2>
<p>A bifactor model is a useful way to represent a multidimensional structure. In this model, there’s a general factor that affects all items, while additional specific factors (or group factors) explain the relationships (covariation) between certain subsets of items beyond what the general factor accounts for.</p>
<p>For the model to work correctly, the general factor needs to be uncorrelated with the specific factors. In contrast to other Confirmatory Factor Analysis (CFA) models where all factors can correlate freely, allowing the general factor to correlate with a specific factor in a bifactor model can lead to issues like non-convergence or incorrect solutions.</p>
<section id="omega-hierarchical-ωh" class="level3">
<h3 class="anchored" data-anchor-id="omega-hierarchical-ωh">Omega Hierarchical (ωh)</h3>
<p>When data fits well with a bifactor model, a reliability metric called <strong>omega hierarchical (</strong><span class="math inline">\(ω_h\)</span>) is used. This measure reflects how much of the total score’s variance is attributable to the single general factor, even though the data involves multiple dimensions.</p>
<p>Here, let’s demonstrate the estimation of <span class="math inline">\(ω_h\)</span> using R, I use data that from Flake, Ferland, &amp; Flora, 2017 collected by administering the PCS to 154 students in an introductory statistics course.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pcs <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"pcs.csv"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pcs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "TE1"  "TE2"  "TE3"  "TE4"  "TE5"  "OE1"  "OE2"  "OE3"  "OE4"  "LVA1"
[11] "LVA2" "LVA3" "LVA4" "EM1"  "EM2"  "EM3"  "EM4"  "EM5"  "EM6" </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>modBf <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="st">gen =~ TE1+TE2+TE3+TE4+TE5+OE1+OE2+OE3+OE4+LVA1+LVA2+LVA3+LVA4 +EM1+EM2+EM3+EM4+EM5+EM6</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="st">s1 =~ TE1 + TE2 + TE3 + TE4 + TE5</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="st">s2 =~ OE1 + OE2 + OE3 + OE4</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="st">s3 =~ LVA1 + LVA2 + LVA3 + LVA4</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="st">s4 =~ EM1 + EM2 + EM3 + EM4 + EM5 + EM6</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Specify model</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>fitBf <span class="ot">&lt;-</span> <span class="fu">cfa</span>(modBf, <span class="at">data=</span>pcs, <span class="at">std.lv=</span>T, <span class="at">estimator=</span><span class="st">'MLR'</span>, <span class="at">orthogonal=</span>T)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Retrieving the results</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitBf, <span class="at">fit.measures=</span><span class="cn">TRUE</span>, <span class="at">standardized=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 36 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        57

                                                  Used       Total
  Number of observations                           154         172

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               211.382     182.509
  Degrees of freedom                               133         133
  P-value (Chi-square)                           0.000       0.003
  Scaling correction factor                                  1.158
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              2799.877    2260.239
  Degrees of freedom                               171         171
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.239

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.970       0.976
  Tucker-Lewis Index (TLI)                       0.962       0.970
                                                                  
  Robust Comparative Fit Index (CFI)                         0.978
  Robust Tucker-Lewis Index (TLI)                            0.972

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3456.819   -3456.819
  Scaling correction factor                                  1.269
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)      -3351.128   -3351.128
  Scaling correction factor                                  1.191
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                                7027.638    7027.638
  Bayesian (BIC)                              7200.744    7200.744
  Sample-size adjusted Bayesian (SABIC)       7020.331    7020.331

Root Mean Square Error of Approximation:

  RMSEA                                          0.062       0.049
  90 Percent confidence interval - lower         0.046       0.031
  90 Percent confidence interval - upper         0.077       0.065
  P-value H_0: RMSEA &lt;= 0.050                    0.108       0.520
  P-value H_0: RMSEA &gt;= 0.080                    0.025       0.000
                                                                  
  Robust RMSEA                                               0.053
  90 Percent confidence interval - lower                     0.032
  90 Percent confidence interval - upper                     0.071
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.387
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.005

Standardized Root Mean Square Residual:

  SRMR                                           0.038       0.038

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  gen =~                                                                
    TE1               1.041    0.071   14.715    0.000    1.041    0.843
    TE2               1.045    0.084   12.430    0.000    1.045    0.794
    TE3               0.848    0.090    9.392    0.000    0.848    0.721
    TE4               0.984    0.075   13.097    0.000    0.984    0.834
    TE5               1.004    0.082   12.264    0.000    1.004    0.819
    OE1               0.787    0.083    9.537    0.000    0.787    0.631
    OE2               0.819    0.080   10.207    0.000    0.819    0.695
    OE3               0.738    0.089    8.319    0.000    0.738    0.605
    OE4               0.742    0.087    8.512    0.000    0.742    0.636
    LVA1              0.937    0.084   11.180    0.000    0.937    0.796
    LVA2              0.863    0.071   12.205    0.000    0.863    0.797
    LVA3              0.816    0.085    9.649    0.000    0.816    0.719
    LVA4              0.865    0.098    8.802    0.000    0.865    0.695
    EM1               0.968    0.095   10.215    0.000    0.968    0.715
    EM2               0.930    0.078   11.957    0.000    0.930    0.800
    EM3               0.959    0.091   10.542    0.000    0.959    0.731
    EM4               0.885    0.091    9.679    0.000    0.885    0.732
    EM5               1.043    0.086   12.121    0.000    1.043    0.816
    EM6               1.108    0.100   11.054    0.000    1.108    0.750
  s1 =~                                                                 
    TE1               0.351    0.114    3.071    0.002    0.351    0.285
    TE2               0.451    0.144    3.142    0.002    0.451    0.343
    TE3               0.402    0.170    2.360    0.018    0.402    0.342
    TE4               0.162    0.111    1.457    0.145    0.162    0.137
    TE5               0.269    0.154    1.747    0.081    0.269    0.219
  s2 =~                                                                 
    OE1               0.626    0.107    5.860    0.000    0.626    0.502
    OE2               0.516    0.096    5.399    0.000    0.516    0.438
    OE3               0.673    0.107    6.291    0.000    0.673    0.552
    OE4               0.739    0.085    8.738    0.000    0.739    0.634
  s3 =~                                                                 
    LVA1              0.253    0.107    2.357    0.018    0.253    0.215
    LVA2              0.573    0.081    7.081    0.000    0.573    0.529
    LVA3              0.422    0.104    4.051    0.000    0.422    0.372
    LVA4              0.528    0.104    5.074    0.000    0.528    0.424
  s4 =~                                                                 
    EM1               0.506    0.152    3.324    0.001    0.506    0.374
    EM2               0.346    0.086    4.026    0.000    0.346    0.298
    EM3               0.567    0.121    4.682    0.000    0.567    0.432
    EM4               0.562    0.098    5.707    0.000    0.562    0.464
    EM5               0.479    0.097    4.930    0.000    0.479    0.375
    EM6               0.651    0.148    4.403    0.000    0.651    0.440

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  gen ~~                                                                
    s1                0.000                               0.000    0.000
    s2                0.000                               0.000    0.000
    s3                0.000                               0.000    0.000
    s4                0.000                               0.000    0.000
  s1 ~~                                                                 
    s2                0.000                               0.000    0.000
    s3                0.000                               0.000    0.000
    s4                0.000                               0.000    0.000
  s2 ~~                                                                 
    s3                0.000                               0.000    0.000
    s4                0.000                               0.000    0.000
  s3 ~~                                                                 
    s4                0.000                               0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .TE1               0.318    0.067    4.777    0.000    0.318    0.209
   .TE2               0.434    0.088    4.913    0.000    0.434    0.251
   .TE3               0.501    0.104    4.827    0.000    0.501    0.363
   .TE4               0.397    0.066    5.987    0.000    0.397    0.285
   .TE5               0.421    0.073    5.799    0.000    0.421    0.281
   .OE1               0.546    0.106    5.129    0.000    0.546    0.350
   .OE2               0.451    0.075    6.003    0.000    0.451    0.325
   .OE3               0.490    0.117    4.183    0.000    0.490    0.330
   .OE4               0.263    0.071    3.718    0.000    0.263    0.194
   .LVA1              0.442    0.064    6.873    0.000    0.442    0.320
   .LVA2              0.100    0.062    1.607    0.108    0.100    0.085
   .LVA3              0.443    0.075    5.892    0.000    0.443    0.344
   .LVA4              0.523    0.088    5.954    0.000    0.523    0.337
   .EM1               0.639    0.100    6.388    0.000    0.639    0.349
   .EM2               0.365    0.060    6.049    0.000    0.365    0.271
   .EM3               0.482    0.090    5.383    0.000    0.482    0.280
   .EM4               0.364    0.083    4.395    0.000    0.364    0.249
   .EM5               0.318    0.063    5.032    0.000    0.318    0.195
   .EM6               0.534    0.117    4.564    0.000    0.534    0.244
    gen               1.000                               1.000    1.000
    s1                1.000                               1.000    1.000
    s2                1.000                               1.000    1.000
    s3                1.000                               1.000    1.000
    s4                1.000                               1.000    1.000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitmeasures</span>(fitBf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         npar                          fmin 
                       57.000                         0.686 
                        chisq                            df 
                      211.382                       133.000 
                       pvalue                  chisq.scaled 
                        0.000                       182.509 
                    df.scaled                 pvalue.scaled 
                      133.000                         0.003 
         chisq.scaling.factor                baseline.chisq 
                        1.158                      2799.877 
                  baseline.df               baseline.pvalue 
                      171.000                         0.000 
        baseline.chisq.scaled            baseline.df.scaled 
                     2260.239                       171.000 
       baseline.pvalue.scaled baseline.chisq.scaling.factor 
                        0.000                         1.239 
                          cfi                           tli 
                        0.970                         0.962 
                   cfi.scaled                    tli.scaled 
                        0.976                         0.970 
                   cfi.robust                    tli.robust 
                        0.978                         0.972 
                         nnfi                           rfi 
                        0.962                         0.903 
                          nfi                          pnfi 
                        0.925                         0.719 
                          ifi                           rni 
                        0.971                         0.970 
                  nnfi.scaled                    rfi.scaled 
                        0.970                         0.896 
                   nfi.scaled                   pnfi.scaled 
                        0.919                         0.715 
                   ifi.scaled                    rni.scaled 
                        0.977                         0.976 
                  nnfi.robust                    rni.robust 
                        0.972                         0.978 
                         logl             unrestricted.logl 
                    -3456.819                     -3351.128 
                          aic                           bic 
                     7027.638                      7200.744 
                       ntotal                          bic2 
                      154.000                      7020.331 
            scaling.factor.h1             scaling.factor.h0 
                        1.191                         1.269 
                        rmsea                rmsea.ci.lower 
                        0.062                         0.046 
               rmsea.ci.upper                rmsea.ci.level 
                        0.077                         0.900 
                 rmsea.pvalue                rmsea.close.h0 
                        0.108                         0.050 
        rmsea.notclose.pvalue             rmsea.notclose.h0 
                        0.025                         0.080 
                 rmsea.scaled         rmsea.ci.lower.scaled 
                        0.049                         0.031 
        rmsea.ci.upper.scaled           rmsea.pvalue.scaled 
                        0.065                         0.520 
 rmsea.notclose.pvalue.scaled                  rmsea.robust 
                        0.000                         0.053 
        rmsea.ci.lower.robust         rmsea.ci.upper.robust 
                        0.032                         0.071 
          rmsea.pvalue.robust  rmsea.notclose.pvalue.robust 
                        0.387                         0.005 
                          rmr                    rmr_nomean 
                        0.056                         0.056 
                         srmr                  srmr_bentler 
                        0.038                         0.038 
          srmr_bentler_nomean                          crmr 
                        0.038                         0.040 
                  crmr_nomean                    srmr_mplus 
                        0.040                         0.038 
            srmr_mplus_nomean                         cn_05 
                        0.038                       118.233 
                        cn_01                           gfi 
                      127.659                         0.877 
                         agfi                          pgfi 
                        0.824                         0.614 
                          mfi                          ecvi 
                        0.775                         2.113 </code></pre>
</div>
</div>
<p>From the results above, we can the bifactor model fits the PCS data well, with robust model-fit statistics, CFI = 0.978, TLI = 0.972, RMSEA = 0.053. Thus, it is reasonable to calculate <span class="math inline">\(ω_h\)</span> to estimate how reliably the PCS total score measures the general psychological-cost factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reliability</span>(fitBf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             gen         s1        s2        s3        s4
alpha  0.9638781 0.92504205 0.8992820 0.9052459 0.9405882
omega  0.9741033 0.56377307 0.7884791 0.6766430 0.7816839
omega2 0.9094893 0.09237594 0.3666293 0.1880759 0.2054075
omega3 0.9077636 0.09240479 0.3666634 0.1878380 0.2053012
avevar        NA         NA        NA        NA        NA</code></pre>
</div>
</div>
<p>The values shown under the “gen” column relate to the general psychological cost factor. The omega estimate (0.974) doesn’t take the specific factors into account when calculating the variance of the total score, so it’s not the appropriate reliability measure for the PCS total score. Instead, the <strong>omega2</strong> and <strong>omega3</strong> values under “gen” represent <strong>omega hierarchical (</strong><span class="math inline">\(ω_h\)</span>). The difference between them is that <strong>omega2</strong> uses the model-implied variance of the total score, while <strong>omega3</strong> relies on the observed variance from the sample.</p>
<p>In simple terms, both <span class="math inline">\(ω_h\)</span> values tell us that <strong>91% of the variance in the PCS total score</strong> is explained by the general psychological cost factor, after accounting for the specific factors that influence different content areas.</p>
</section>
<section id="higher-order-models" class="level3">
<h3 class="anchored" data-anchor-id="higher-order-models">Higher-Order Models</h3>
<p>In the bifactor model example, I treated the multidimensional nature of the PCS items as a distraction when measuring a broad, general psychological cost construct. However, in other cases, researchers may propose a different structure where a broad overarching factor indirectly influences all the test items by acting through more specific, narrower constructs that directly affect different subsets of items. This kind of setup suggests a <strong>higher-order model</strong>, where a higher-order (or second-order) factor drives differences in several lower-order (first-order) factors, which, in turn, influence the individual item responses.</p>
<p>In this model, researchers assess how well the test captures both the overall score (reflecting the broad higher-order construct) and the subscale scores (reflecting the more specific lower-order constructs).</p>
<p>When the data fit a higher-order model, the reliability of the total score is measured by <strong>omega-higher-order (</strong><span class="math inline">\(ω_{ho}\)</span>), which represents the proportion of the total score’s variance that can be attributed to the higher-order factor. The calculation of ωho uses parameter estimates from the higher-order model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Specify the higher-order factor model for the PCS items</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>homod <span class="ot">&lt;-</span> <span class="st">'TE =~ TE1 + TE2 + TE3 + TE4 + TE5 </span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="st">      OE =~ OE1 + OE2 + OE3 + OE4</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="st">      LV =~ LVA1 + LVA2 + LVA3 + LVA4</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="st">      EM =~ EM1 + EM2 + EM3 + EM4 + EM5 + EM6</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="st">      cost =~ TE + OE + LV + EM'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Estimate the model and get the results</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>fitHo <span class="ot">&lt;-</span> <span class="fu">cfa</span>(homod, <span class="at">data=</span>pcs, <span class="at">std.lv=</span>T, <span class="at">estimator=</span><span class="st">'MLM'</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitHo, <span class="at">fit.measures=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 57 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        42

                                                  Used       Total
  Number of observations                           154         172

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               243.444     185.699
  Degrees of freedom                               148         148
  P-value (Chi-square)                           0.000       0.019
  Scaling correction factor                                  1.311
    Satorra-Bentler correction                                    

Model Test Baseline Model:

  Test statistic                              2799.877    2282.637
  Degrees of freedom                               171         171
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.227

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.964       0.982
  Tucker-Lewis Index (TLI)                       0.958       0.979
                                                                  
  Robust Comparative Fit Index (CFI)                         0.981
  Robust Tucker-Lewis Index (TLI)                            0.978

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3472.850   -3472.850
  Loglikelihood unrestricted model (H1)      -3351.128   -3351.128
                                                                  
  Akaike (AIC)                                7029.700    7029.700
  Bayesian (BIC)                              7157.252    7157.252
  Sample-size adjusted Bayesian (SABIC)       7024.315    7024.315

Root Mean Square Error of Approximation:

  RMSEA                                          0.065       0.041
  90 Percent confidence interval - lower         0.050       0.021
  90 Percent confidence interval - upper         0.079       0.056
  P-value H_0: RMSEA &lt;= 0.050                    0.052       0.832
  P-value H_0: RMSEA &gt;= 0.080                    0.039       0.000
                                                                  
  Robust RMSEA                                               0.047
  90 Percent confidence interval - lower                     0.020
  90 Percent confidence interval - upper                     0.066
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.592
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.002

Standardized Root Mean Square Residual:

  SRMR                                           0.045       0.045

Parameter Estimates:

  Standard errors                           Robust.sem
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  TE =~                                               
    TE1               0.356    0.067    5.289    0.000
    TE2               0.364    0.065    5.554    0.000
    TE3               0.299    0.059    5.056    0.000
    TE4               0.323    0.058    5.605    0.000
    TE5               0.338    0.065    5.198    0.000
  OE =~                                               
    OE1               0.641    0.074    8.642    0.000
    OE2               0.616    0.060   10.334    0.000
    OE3               0.630    0.066    9.523    0.000
    OE4               0.647    0.064   10.078    0.000
  LV =~                                               
    LVA1              0.442    0.056    7.836    0.000
    LVA2              0.457    0.059    7.751    0.000
    LVA3              0.427    0.059    7.286    0.000
    LVA4              0.460    0.056    8.258    0.000
  EM =~                                               
    EM1               0.509    0.069    7.394    0.000
    EM2               0.462    0.066    7.018    0.000
    EM3               0.517    0.074    6.955    0.000
    EM4               0.483    0.067    7.179    0.000
    EM5               0.535    0.069    7.756    0.000
    EM6               0.595    0.080    7.430    0.000
  cost =~                                             
    TE                2.914    0.595    4.894    0.000
    OE                1.223    0.155    7.880    0.000
    LV                1.951    0.281    6.933    0.000
    EM                1.900    0.327    5.809    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .TE1               0.321    0.063    5.081    0.000
   .TE2               0.473    0.069    6.837    0.000
   .TE3               0.531    0.100    5.289    0.000
   .TE4               0.398    0.073    5.494    0.000
   .TE5               0.418    0.070    5.935    0.000
   .OE1               0.531    0.099    5.353    0.000
   .OE2               0.440    0.081    5.428    0.000
   .OE3               0.495    0.099    5.001    0.000
   .OE4               0.315    0.055    5.719    0.000
   .LVA1              0.443    0.081    5.466    0.000
   .LVA2              0.170    0.035    4.851    0.000
   .LVA3              0.412    0.064    6.473    0.000
   .LVA4              0.533    0.090    5.945    0.000
   .EM1               0.637    0.085    7.508    0.000
   .EM2               0.367    0.062    5.872    0.000
   .EM3               0.493    0.075    6.564    0.000
   .EM4               0.387    0.064    6.017    0.000
   .EM5               0.315    0.062    5.059    0.000
   .EM6               0.554    0.085    6.515    0.000
   .TE                1.000                           
   .OE                1.000                           
   .LV                1.000                           
   .EM                1.000                           
    cost              1.000                           </code></pre>
</div>
</div>
<section id="lets-obtain-omega-ho-from-a-higher-order-model-for-the-psychological-cost-scale" class="level4">
<h4 class="anchored" data-anchor-id="lets-obtain-omega-ho-from-a-higher-order-model-for-the-psychological-cost-scale">Let’s obtain omega-ho from a higher-order model for the Psychological Cost Scale</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reliabilityL2</span>(fitHo, <span class="st">'cost'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       omegaL1        omegaL2 partialOmegaL1 
     0.9088176      0.9410190      0.9734520 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Obtain omega estimates for the subscale scores as measures of the lower-order factors</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">reliability</span>(fitHo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              TE        OE        LV        EM
alpha  0.9250420 0.8992820 0.9052459 0.9405882
omega  0.9260209 0.9000548 0.9077522 0.9415490
omega2 0.9260209 0.9000548 0.9077522 0.9415490
omega3 0.9256773 0.9014397 0.9125259 0.9404921
avevar 0.7155347 0.6925123 0.7111716 0.7299181</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="exploratory-omega-estimates" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-omega-estimates">Exploratory Omega Estimates</h2>
<p>So far, the examples have relied on semTools’ <code>reliability</code> (or <code>reliabilityL2</code>) function to calculate omega estimates based on CFA models. However, these omega estimates are only valid if the underlying model for the test is correctly specified. For instance, using <span class="math inline">\(ω_u\)</span> as a reliability estimate wouldn’t be appropriate if the true model is multidimensional, as indicated by a poor fit for a single-factor model.</p>
<p>When a hypothesized CFA model doesn’t adequately fit the data—which is common in the early stages of test development—Exploratory Factor Analysis (EFA) can help identify the test’s dimensional structure. After determining the optimal number of factors for a test, you can use the <code>omega</code> function from the <strong>psych</strong> package (Revelle, 2020) to estimate omega based on the EFA parameters. This estimate will reflect the proportion of total score variance attributable to a general factor that influences all items.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Determine number of factors</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">n_factors</span>(pcs, <span class="at">package =</span> <span class="st">"all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Method Agreement Procedure:

The choice of 4 dimensions is supported by 7 (25.93%) methods out of 27 (beta, Scree (SE), EGA (glasso), Velicer's MAP, BIC, Fit_off, BIC).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Determine omega for 4 factor model</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">omega</span>(pcs, <span class="at">nfactors =</span> <span class="dv">4</span>, <span class="at">plot =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required namespace: GPArotation</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Omega 
Call: omegah(m = m, nfactors = nfactors, fm = fm, key = key, flip = flip, 
    digits = digits, title = title, sl = sl, labels = labels, 
    plot = plot, n.obs = n.obs, rotate = rotate, Phi = Phi, option = option, 
    covar = covar)
Alpha:                 0.96 
G.6:                   0.98 
Omega Hierarchical:    0.85 
Omega H asymptotic:    0.88 
Omega Total            0.98 

Schmid Leiman Factor loadings greater than  0.2 
        g   F1*   F2*   F3*   F4*   h2   h2   u2   p2  com
TE1  0.81              0.39       0.81 0.81 0.19 0.80 1.50
TE2  0.76              0.40       0.75 0.75 0.25 0.77 1.53
TE3  0.70              0.35       0.62 0.62 0.38 0.80 1.52
TE4  0.78              0.29       0.72 0.72 0.28 0.84 1.41
TE5  0.77              0.34       0.74 0.74 0.26 0.80 1.46
OE1  0.61        0.55             0.67 0.67 0.33 0.56 2.02
OE2  0.67        0.46             0.66 0.66 0.34 0.68 1.81
OE3  0.61        0.54             0.68 0.68 0.32 0.54 2.02
OE4  0.63        0.62             0.80 0.80 0.20 0.50 2.02
LVA1 0.75                    0.28 0.67 0.67 0.33 0.85 1.37
LVA2 0.80                    0.48 0.87 0.87 0.13 0.73 1.66
LVA3 0.71        0.20        0.37 0.71 0.71 0.29 0.72 1.69
LVA4 0.70                    0.43 0.67 0.67 0.33 0.72 1.68
EM1  0.69  0.39                   0.66 0.66 0.34 0.73 1.64
EM2  0.76  0.38                   0.75 0.75 0.25 0.77 1.57
EM3  0.72  0.47                   0.73 0.73 0.27 0.71 1.76
EM4  0.72  0.48                   0.74 0.74 0.26 0.70 1.76
EM5  0.78  0.43                   0.81 0.81 0.19 0.76 1.59
EM6  0.73  0.48                   0.78 0.78 0.22 0.68 1.78

With Sums of squares  of:
    g   F1*   F2*   F3*   F4*    h2 
 9.95  1.21  1.29  0.70  0.68 10.16 

general/max  0.98   max/min =   14.84
mean percent general =  0.72    with sd =  0.1 and cv of  0.13 
Explained Common Variance of the general factor =  0.72 

The degrees of freedom are 101  and the fit is  1 
The number of observations was  172  with Chi Square =  161.11  with prob &lt;  0.00013
The root mean square of the residuals is  0.02 
The df corrected root mean square of the residuals is  0.03
RMSEA index =  0.059  and the 10 % confidence intervals are  0.041 0.076
BIC =  -358.79

Compare this with the adequacy of just a general factor and no group factors
The degrees of freedom for just the general factor are 152  and the fit is  4.49 
The number of observations was  172  with Chi Square =  732.57  with prob &lt;  8.2e-77
The root mean square of the residuals is  0.1 
The df corrected root mean square of the residuals is  0.11 

RMSEA index =  0.149  and the 10 % confidence intervals are  0.139 0.16
BIC =  -49.85 

Measures of factor score adequacy             
                                                 g  F1*  F2*  F3*  F4*
Correlation of scores with factors            0.93 0.79 0.86 0.72 0.77
Multiple R square of scores with factors      0.86 0.63 0.73 0.52 0.59
Minimum correlation of factor score estimates 0.73 0.26 0.47 0.04 0.18

 Total, General and Subset omega for each subset
                                                 g  F1*  F2*  F3* F4*
Omega total for total scores and subscales    0.98 0.94 0.90 0.92 0.9
Omega general for total scores and subscales  0.85 0.69 0.52 0.76 0.7
Omega group for total scores and subscales    0.08 0.25 0.38 0.16 0.2</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>